<div>
    <p class="text-center"><b>TRONGATE FRAMEWORK DOCUMENTATION</b></p>
    <h1>Table Of Contents</h1>
    <div class="toc-grid">
        <?php
        $page_counter = 0;
        foreach($table_of_contents as $chapter_key => $chapter) {
            
        ?>
        <div class="card">
          <div class="card-body">
            <h2><?= $chapter['dir_label'] ?></h2>

            <ul>
                <?php
                $root_url = BASE_URL;
                $files = $chapter['files'];

                if ($chapter_key === count($table_of_contents)-1) {
                    // Comprehensive Reference Guide START

                    $sub_directories = $chapter['sub_directories'];
                    foreach($sub_directories as $sub_directory) {
                        $dir_label = $sub_directory['dir_label'];
                        echo '<h3>'.$dir_label.'</h3>';

                        foreach($sub_directory['sub_directories'] as $dir) {

                            if (isset($dir['files'][0])) {
                               
                                $page_url = $dir['files'][0]['page_url'];

                                // Trim leading and trailing slashes then split the path into segments
                                $segments = explode('/', trim($page_url, '/'));

                                // Remove the last segment
                                array_pop($segments);

                                // Reconstruct the URL without the last segment
                                $page_url = implode('/', $segments);

                            } else {
                                $page_url = '#';
                            }

                            $page_counter++;
                            echo '<li><div><a href="'.$page_url.'">'.$dir['dir_label'].'</a></div><div>'.$page_counter.'</div></li>';
                        }

                    }


                    // Comprehensive Reference Guide END
                } else {

                    foreach($files as $file) {
                        $page_counter++;
                         echo '<li><div><a href="'.$file['page_url'].'">'.$file['label'].'</a></div><div>'.$page_counter.'</div></li>';
                    }

                }
                ?>
            </ul>
          </div>
        </div>
        <?php
        }
        ?>
    </div>

</div>

